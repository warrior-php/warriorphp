(function () {
    "use strict";

    function initAdminSettings() {
        if (typeof userSettings === "undefined") {
            console.warn("userSettings 未定义，AdminSettings 未执行");
            return;
        }

        const settings = Object.assign({}, userSettings);

        const AdminSettings = {
            AdminSettingsInit() {
                this.ManageThemeLayout();
                this.ManageSidebarType();
                this.ManageBoxedLayout();
                this.ManageDirectionLayout();
                this.ManageDarkThemeLayout();
                this.ManageColorThemeLayout();
                this.ManageCardLayout();
            },
            ManageThemeLayout() {
                const horizontalLayoutElement = document.getElementById("horizontal-layout");
                const verticalLayoutElement = document.getElementById("vertical-layout");
                switch (settings.Layout) {
                    case "horizontal":
                        if (horizontalLayoutElement) horizontalLayoutElement.checked = true;
                        document.documentElement.setAttribute("data-layout", "horizontal");
                        break;
                    case "vertical":
                        if (verticalLayoutElement) verticalLayoutElement.checked = true;
                        document.documentElement.setAttribute("data-layout", "vertical");
                        break;
                }
            },
            ManageSidebarType() {
                switch (settings.SidebarType) {
                    case "full":
                        const fullSidebarElement = document.querySelector("#full-sidebar");
                        if (fullSidebarElement) fullSidebarElement.checked = true;
                        document.body.setAttribute("data-sidebartype", "full");
                        const setSidebarType = () => {
                            const width = window.innerWidth > 0 ? window.innerWidth : screen.width;
                            document.body.setAttribute("data-sidebartype", width < 1300 ? "mini-sidebar" : "full");
                        };
                        window.addEventListener("DOMContentLoaded", setSidebarType);
                        window.addEventListener("resize", setSidebarType);
                        break;
                    case "mini-sidebar":
                        const miniSidebarElement = document.querySelector("#mini-sidebar");
                        if (miniSidebarElement) miniSidebarElement.checked = true;
                        document.body.setAttribute("data-sidebartype", "mini-sidebar");
                        break;
                }
            },
            ManageBoxedLayout() {
                const boxedLayoutElement = document.getElementById("boxed-layout");
                const fullLayoutElement = document.getElementById("full-layout");
                switch (settings.BoxedLayout) {
                    case true:
                        document.documentElement.setAttribute("data-boxed-layout", "boxed");
                        if (boxedLayoutElement) boxedLayoutElement.checked = true;
                        break;
                    case false:
                        document.documentElement.setAttribute("data-boxed-layout", "full");
                        if (fullLayoutElement) fullLayoutElement.checked = true;
                        break;
                }
            },
            ManageDirectionLayout() {
                const ltrLayoutElement = document.getElementById("ltr-layout");
                const rtlLayoutElement = document.getElementById("rtl-layout");
                switch (settings.Direction) {
                    case "ltr":
                        if (ltrLayoutElement) ltrLayoutElement.checked = true;
                        document.documentElement.setAttribute("dir", "ltr");
                        const offcanvasStart = document.querySelector(".offcanvas-start");
                        if (offcanvasStart) {
                            offcanvasStart.classList.toggle("offcanvas-end");
                            offcanvasStart.classList.remove("offcanvas-start");
                        }
                        break;
                    case "rtl":
                        document.documentElement.setAttribute("dir", "rtl");
                        const offcanvasEnd = document.querySelector(".offcanvas-end");
                        if (offcanvasEnd) {
                            offcanvasEnd.classList.toggle("offcanvas-start");
                            offcanvasEnd.classList.remove("offcanvas-end");
                        }
                        if (rtlLayoutElement) rtlLayoutElement.checked = true;
                        break;
                }
            },
            ManageCardLayout() {
                const cardWithoutBorderElement = document.getElementById("card-without-border");
                const cardWithBorderElement = document.getElementById("card-with-border");
                switch (settings.cardBorder) {
                    case true:
                        document.documentElement.setAttribute("data-card", "border");
                        if (cardWithBorderElement) cardWithBorderElement.checked = true;
                        break;
                    case false:
                        document.documentElement.setAttribute("data-card", "shadow");
                        if (cardWithoutBorderElement) cardWithoutBorderElement.checked = true;
                        break;
                }
            },
            ManageDarkThemeLayout() {
                const setTheme = (theme, hideElements, showElements, hideElements2) => {
                    document.documentElement.setAttribute("data-bs-theme", theme);
                    const themeLayoutElement = document.getElementById(`${theme}-layout`);
                    if (themeLayoutElement) themeLayoutElement.checked = true;
                    hideElements.forEach((el) =>
                        document.querySelectorAll(`.${el}`).forEach((e) => (e.style.display = "none"))
                    );
                    showElements.forEach((el) =>
                        document.querySelectorAll(`.${el}`).forEach((e) => (e.style.display = "flex"))
                    );
                    hideElements2.forEach((el) =>
                        document.querySelectorAll(`.${el}`).forEach((e) => (e.style.display = "none"))
                    );
                };
                switch (settings.Theme) {
                    case "light":
                        setTheme("light", ["light-logo"], ["moon"], ["sun"]);
                        break;
                    case "dark":
                        setTheme("dark", ["dark-logo"], ["sun"], ["moon"]);
                        break;
                }
            },
            ManageColorThemeLayout() {
                const {ColorTheme} = settings;
                const colorThemeElement = document.getElementById(ColorTheme);
                if (colorThemeElement) {
                    document.documentElement.setAttribute("data-color-theme", ColorTheme);
                    colorThemeElement.checked = true;
                }
            },
        };

        // 初始化设置
        AdminSettings.AdminSettingsInit();

        // 注册交互事件
        document.addEventListener("DOMContentLoaded", registerClickHandlers);
    }

    function registerClickHandlers() {
        // ...（保持原始点击逻辑，这部分不改）
    }

    // 确保在 DOM 就绪时执行
    if (document.readyState === "loading") {
        document.addEventListener("DOMContentLoaded", initAdminSettings);
    } else {
        initAdminSettings();
    }
})();
